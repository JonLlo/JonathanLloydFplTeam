<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>FPL Chat Assistant</title>
<style>
  body { font-family: Arial, sans-serif; padding: 20px; background: #f0f0f0; }
  #chat { max-width: 600px; margin: auto; background: white; padding: 20px; border-radius: 10px; }
  #messages { height: 300px; overflow-y: auto; border: 1px solid #ccc; padding: 10px; margin-bottom: 10px; }
  .user { color: blue; }
  .assistant { color: green; }
  input { width: 80%; padding: 10px; }
  button { padding: 10px; }
</style>
</head>
<body>

<div id="chat">
  <div id="messages"></div>
  <input id="messageInput" placeholder="Ask a question..." />
  <button onclick="sendMessage()">Send</button>
</div>

<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
<script>
  // Replace with your FPL JSON
  const fplJson = {
    league: { name: "FPL Neeks" },
    standings: {
      results: [
        { player_name: "Fin Russell", entry_name: "Bosh Ball", total: 707, event_total: 56 },
        { player_name: "Gabriel Furey", entry_name: "McNeil Deal", total: 690, event_total: 47 },
        { player_name: "Thomas Rice-Hird", entry_name: "Zubimandem", total: 686, event_total: 54 },
        // ...add more if needed
      ]
    }
  };

  const messagesDiv = document.getElementById('messages');

  async function sendMessage() {
    const input = document.getElementById('messageInput');
    const question = input.value.trim();
    if (!question) return;

    appendMessage('user', question);
    input.value = '';

    // Build system + user messages for GPT
    const prompt = `
You are a Fantasy Premier League assistant. You will receive this league summary:

${JSON.stringify(fplJson, null, 2)}

Answer questions using this summary. If information is missing, you may give a reasonable estimate. Answer in a friendly Jamaican accent.
Question: ${question}
`;

    try {
      const response = await axios.post('https://api.openai.com/v1/chat/completions', {
        model: "gpt-4o-mini",
        messages: [{ role: "user", content: prompt }]
      }, {
        headers: {
          'Authorization': 'Bearer YOUR_OPENAI_API_KEY',
          'Content-Type': 'application/json'
        }
      });

      const answer = response.data.choices[0].message.content;
      appendMessage('assistant', answer);

    } catch (err) {
      console.error(err);
      appendMessage('assistant', "Error: " + err.message);
    }
  }

  function appendMessage(role, text) {
    const p = document.createElement('p');
    p.className = role;
    p.textContent = (role === 'user' ? 'You: ' : 'FPL GPT: ') + text;
    messagesDiv.appendChild(p);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  }
</script>

</body>
</html>
